---
title: "실험계획법 (DOE)"
---

## DOE 개요 {#doe-overview}

![슬라이드 6](../images/ch06/slide_06.png){width=100%}

**DOE (Design of Experiments, 실험계획법)**: 프로세스의 환경과 인자를 통제(Control)하여, 필요한 데이터를 수집하고 분석하는 방법

**목적**: 어떻게 하면 최소 회수의 실험을 통해 최대의 정보를 신속하게 얻을 수 있을 것인가?

**DOE에서의 용어**:

| 용어 | 설명 |
|------|------|
| **Y (반응값, Response)** | 실험 결과로 측정되는 출력 변수 |
| **x (인자, Factor)** | 반응값에 영향을 주는 원인 변수 |
| **수준 (Level)** | 각 인자의 실험 진행 조건 |
| **처리 (Treatment)** | 실험의 실시 조건, 수준 조합 |

::: {.callout-note title="요인 vs 인자" collapse="true"}
반응값에 영향을 주는 원인(x's)들을 **요인**이라 하고, 요인들 중 실험을 위해 선택된 요인을 **인자**라고 합니다. 실무에서는 구분 없이 "인자"라는 단어로 사용하고 있습니다.
:::

---

### 실험설계의 종류

![슬라이드 7](../images/ch06/slide_07.png){width=100%}

실험의 목적에 따라 적합한 실험설계 방법을 선정해야 합니다.

| 실험 목적 | 설계 방법 |
|-----------|-----------|
| **Screening** (치명인자 선정) | 2ⁿ Factorial Design, 부분배치법, 2ⁿ FD + 중심점 |
| **최적화/예측** | General Full Factorial Design, Block Design & ANOCOVA, RSM |

::: {.callout-warning}
- 교재에서 설명되는 실험계획법들은 모두 **"평균"에 대해 해석**하는 방법입니다
- 분산에 대한 해석을 위해서는 **다구찌 실험계획법** 사용을 권장합니다
- M단계에서 산포개선(Zst)을 해야 하는 과제이면 교재의 실험계획법으로는 문제 해결이 어려울 수 있습니다
:::

---

### DOE 용어 상세

![슬라이드 8](../images/ch06/slide_08.png){width=100%}

**(1) 인자(Factor)**:

- **모수인자 (Fixed factor)**: 수준의 선택이 기술적으로 정해져 있고 각 수준이 기술적 의미를 가지고 있는 인자 (예: 길이, 무게, 압력)
- **변량인자 (Random factor)**: 수준의 선택이 임의적으로 이루어지며 각 수준이 기술적 의미를 가지고 있지 않은 인자 (예: 랜덤하게 뽑은 제품, 시험일로 선택된 날짜)

**(2) 수준(Level)**: 실험을 하기 위한 인자들의 정량적인 값이나 선택한 것 (예: 10m/20m, 남/여)

- 단순 비교: 2수준 주로 사용
- 최적 조건 탐색: 3수준 이상
- 초기 실험 수준은 **흥미영역 내에서 가능한 넓게** 선정

**(3) 모형(Model)**:

| 모형 | 설명 |
|------|------|
| **모수 모형 (Fixed model)** | 인자들이 모두 모수인자로만 구성 |
| **변량 모형 (Random model)** | 인자들이 모두 변량인자로만 구성 |
| **혼합 모형 (Mixed model)** | 모수인자와 변량인자가 동시에 포함 |

::: {.callout-tip title="수준수 선정의 효율성" collapse="true"}
수준수를 늘리면 반응값의 변화 패턴을 더 자세히 볼 수 있지만 시간·비용이 증가합니다. 초기 실험은 2수준으로 주요 인자를 먼저 선별하고, 선별된 인자에 대해 수준수를 늘려 2차 실험을 하는 것이 효율적입니다.

**예시**: 가인자 5개 실험 시

- 방법1) 5인자 3수준: 3⁵ = 243회
- 방법2) 1차 5인자 2수준(32회) → 2차 3인자 3수준(27회) = **59회** (184회 절감)
:::

---

## 실험설계의 5대 원리 {#doe-principles}

![슬라이드 9](../images/ch06/slide_09.png){width=100%}

유용한 분석 결과를 위한 실험 설계의 기본 원칙입니다. **실험설계가 분석 방법과 결과를 결정합니다.**

| 원리 | 목적 | 핵심 |
|------|------|------|
| **랜덤화** | 객관성/재현성 확보 | 실험단위의 할당과 실시 순서를 무작위로 결정 |
| **반복** | 정밀성 확보 | 동일한 실험 조건에서 두 번 이상 실험 실시 |
| **블록화** | 정밀성 확보 | 전체 실험 환경을 동질적인 부분으로 나누어 실험 |

::: {.callout-note title="반복 vs 되풀이 / 블록 vs 블록화" collapse="true"}
- **반복(Replication)**: 기초 실험 조건을 **모두** 반복하는 것
- **되풀이(Repetition)**: 특정 실험 조건을 **일부** 반복하는 것
- **블록(Block)**: 동질적 실험 환경(단위)의 모임
- **블록화(Blocking)**: 전체 실험 조건을 일정수의 블록으로 구분함

교락, 직교화를 포함하여 실험의 **5대 원리**라고 합니다.
:::

### ① 랜덤화 (Randomization)

![슬라이드 10](../images/ch06/slide_10.png){width=100%}

의도하지 않은 환경적 요인이나 Noise, 실험자의 주관 등이 실험 결과에 영향을 주지 않도록, 불가피한 영향들을 모든 실험 결과에 **동등하게 분배**되도록 하는 방법입니다.

- 실험 순서의 랜덤화
- 실험 Unit의 랜덤화
- 측정 순서의 랜덤화

표준 순서(StdOrder)와 런 순서(RunOrder)가 다르게 설계되어 있으면 랜덤화 설계가 된 것이며, 실제 실험은 **런 순서**대로 실시합니다.

### ② 반복 (Replication)

![슬라이드 11](../images/ch06/slide_11.png){width=100%}

실험 결과의 정도(정확도+정밀도)를 높이기 위해 동일한 조건에서 **두 번 이상** 실시합니다.

- 실험 오차의 수량화를 위한 **유일한 조치**
- 오차항의 자유도를 크게 해주어 오차 분산의 정도를 높여줌
- 반복 실험을 하지 않을 경우, 오차항과 교호작용의 p-값을 계산할 수 없음 (MSE = 0)

::: {.callout-warning}
반복을 하지 않은 경우, 고차의 교호작용을 **오차항으로 만들어 주어야** 분석이 가능합니다 (Pooling 참조).
:::

### ③ 블록화 (Blocking)

![슬라이드 12](../images/ch06/slide_12.png){width=100%}

실험 오차를 최소화하기 위해 전체 실험환경(단위)을 **동질적인 부분**으로 나누어 실험합니다. Block을 하나의 인자로 하여 그 효과를 별도로 분리하므로, 블록 간 변동을 제외시키고 블록 내 인자들의 변동을 정밀하게 파악할 수 있습니다.

**사례**:

- **농업 실험**: 비옥도가 비슷한 지역끼리 묶어 블록 설정
- **반도체 제조**: 생산 라인, 생산일, 작업자 등을 블록으로 설정
- **임상 시험**: 나이대, 질병 심각도 등을 기준으로 블록을 나눔

### ④ 직교 (Orthogonality)

![슬라이드 13](../images/ch06/slide_13.png){width=100%}

인자 간에 직교성을 갖도록 실험을 설계하면, 같은 실험횟수라도 **검출력과 정도가 더 좋습니다**.

**직교 조건**:

1. 모든 인자는 각 수준에서 **동일한 횟수**로 실험되어야 함
2. 어느 인자의 특정 수준을 고정하고 다른 인자의 설계를 살펴보면, -1과 +1이 **동일 횟수**로 설계되어야 함

Minitab과 같은 통계 S/W 사용 시 자동적으로 직교가 되도록 조합을 선택해 줍니다.

### ⑤ 교락 (Confounding)

![슬라이드 14](../images/ch06/slide_14.png){width=100%}

어떤 인자의 효과와 다른 인자의 효과가 혼합되어 있는 상태를 **교락**되어 있다고 합니다.

- 기술적으로 무시할 수 있는 고차 교호작용을 주인자의 효과에 의도적으로 교락시켜 **실험 횟수를 줄이는** 목적으로 활용
- 일반적으로 3차 이상의 교호작용이 유의한 경우는 거의 없음
- **부분배치법**은 교락의 원리가 적용된 대표적 실험 방법

---

### 실험 설계와 분석의 기본 절차

![슬라이드 15](../images/ch06/slide_15.png){width=100%}

```
실험 목적 설정 → 반응변수(Y) 선정 → 인자(X's) 선정 → 수준 결정
→ 실험 설계 방법 결정 → 실험 실시/데이터 수집 → 데이터 분석
→ 결론 도출 → 확인 실험/최종 결론
```

::: {.callout-important title="실험 설계 시 유의사항"}
- 반응변수는 **연속형 변수**를 지정 (범주형인 경우 연속형 대체 특성 고려)
- 인자는 A 단계에서 확인된 **치명인자**를 지정하되, 가능한 **적은 수**로 결정
- 단순 비교는 2수준, 계량인자 최적화는 **3수준 이상의 홀수 개** 지정
- 확인 실험을 통해 결과의 **재현성**을 확인한 후 최종 결론 도출
:::

---

## 2-Level Factorial Design {#two-level-fd}

![슬라이드 16](../images/ch06/slide_16.png){width=100%}

**2-Level FD**: 모든 인자들의 수준이 2개로 동일한 Factorial Design으로 "2ⁿ FD"로 표기합니다.

- 수준은 (0,1), (-1,+1), (Low, High) 등으로 표현
- 계량 인자의 경우, 반응 패턴은 **1차(직선관계)까지만** 가능
- A 단계 가인자 중 치명인자 선정을 위한 **Screening** 도구로 사용
- FD 중 **가장 최소의 실험 횟수**를 제공하지만, 인자 수가 많아지면 급격히 증가

**효과 계산**: 부호합 = (+수준 효과의 합) - (-수준 효과의 합), 주효과 = 부호합 / 자유도

### STB 4.1 실습 — 소비자 선호도 실험

![슬라이드 17](../images/ch06/slide_17.png){width=100%}

OO전자 제품군의 소비자 선호도 조사를 위한 실험입니다.

- **반응값**: 종합 선호도 (각 군 2명 평균)
- **인자**: 제품군(A), 컬러(B), 크기(C), 기능(D) — 각 2수준
- **총 실험 횟수**: 2⁴ × 1 = 16회 (반복 없음)

#### (1) 실험 설계

![슬라이드 18](../images/ch06/slide_18.png){width=100%}

**Minitab 경로**: Stat > DoE > Factorial > Create Factorial Design

- 인자의 수 지정 → Full Factorial 지정 → 반복 횟수 지정
- 인자의 이름과 수준 입력

![슬라이드 19](../images/ch06/slide_19.png){width=100%}

StdOrder와 RunOrder가 다른 것은 실험설계가 **랜덤하게** 되었음을 의미합니다. 실험 후 결과값을 해당 수준조합에 맞게 입력합니다.

#### (2) 분산분석 — Pooling

![슬라이드 20](../images/ch06/slide_20.png){width=100%}

**Minitab 경로**: Stat > DoE > Factorial > Analyze Factorial Design

반복을 하지 않았으므로 최고차(4인자) 교호작용을 오차항으로 처리합니다.

::: {.callout-tip title="실험 오차로의 Pooling" collapse="true"}
유의하지 않은 교호작용 효과를 실험 모형에서 제거하여 간단한 모형을 설정하기 위한 조치입니다.

**Pooling 규칙**:

- 고차의 교호작용부터 우선 제거
- p값이 유의하지 않은 교호작용 효과를 Pooling
- Pooling 후의 MSE는 **작아지거나 비슷**해야 함 (커지면 Pooling하면 안 됨)
- **주인자는 유의하지 않더라도 절대 Pooling하면 안 됨**

**교락 vs Pooling**:

- **교락**: 실험 설계 시 의도적으로 교호작용 효과를 희생하여 실험 횟수를 줄임
- **Pooling**: 실험 후 결과 해석 과정에서 유의하지 않은 효과를 오차항으로 보냄
:::

![슬라이드 21](../images/ch06/slide_21.png){width=100%}

3차 교호작용을 모두 Pooling한 결과, MSE가 0.52201에서 **0.11996**으로 작아졌습니다.

![슬라이드 22](../images/ch06/slide_22.png){width=100%}

일부 2차 교호작용까지 Pooling한 최종 결과: 유의수준 5%하에서 **B, D, C×D** 인자가 유의합니다.

::: {.callout-warning}
C×D 교호작용이 유의한 경우, C인자는 주효과가 유의하지 않더라도 **무시하거나 제외해서는 안 됩니다**. 추가 실험 시 C인자도 포함해야 합니다.
:::

#### (3) 잔차 분석 및 Effect Plots

![슬라이드 23](../images/ch06/slide_23.png){width=100%}

**Effect Plots**: 유의한 인자 및 교호작용의 효과 크기와 방향성을 나타냅니다.

| 그래프 | 특징 |
|--------|------|
| **파레토 그림** | 효과가 큰 순서대로 크기 표시, 임계값보다 큰 항이 유의 |
| **정규확률그림** | 기준선에서 멀수록 효과가 크며, 효과의 **방향성** 제공 |
| **1/2 정규확률그림** | 절대값으로 크기 표시, 방향성 미제공 |

**잔차 진단**: 정규성(확률도/히스토그램), 등분산성(추정값-잔차 산점도), 독립성(수집순서-잔차 산점도) 확인

#### (4) 분석 후 추정

![슬라이드 24](../images/ch06/slide_24.png){width=100%}

**Minitab 경로**: Stat > DoE > Factorial > Factorial Plots

![슬라이드 25](../images/ch06/slide_25.png){width=100%}

**Main Effects Plot**: 각 주인자(X)가 반응값(Y)에 미치는 효과의 크기를 보여줍니다. 수준 간 결과값 차이가 클수록 유의한 인자이며, 기울기가 클수록 P-value는 작아집니다.

::: {.callout-note}
주효과도는 인자 간 영향도의 순위를 볼 수 있으나, 유의 여부 판단은 **분산분석표의 P-value**로 해야 합니다.
:::

#### 교호작용 해석

![슬라이드 26](../images/ch06/slide_26.png){width=100%}

**교호작용에 대한 Facts**:

- 교호작용은 실험자가 조절할 수 없음
- 실험을 실시하여 분석하기 전에는 명확히 알 수 없음
- 인자들의 수준 범위/값에 따라 달라짐

**Remedies**:

- 최고차의 교호작용이 의심스러운 경우, 실험에서 **반복**을 고려
- 기초 분석에서 "교호작용은 존재한다"라고 가정
- 교호작용이 존재하는 경우 최적 조건은 **교호작용을 중심으로** 도출

![슬라이드 27](../images/ch06/slide_27.png){width=100%}

**Interaction Plot**: 한 인자의 효과가 다른 인자의 수준에 따라 영향을 받는가를 보여주는 그래프입니다. 두 선이 교차하면 교호작용이 있다고 할 수 있습니다.

#### Cube Plot과 최적조건

![슬라이드 28](../images/ch06/slide_28.png){width=100%}

**Cube Plot**: 모든 인자의 모든 수준에서 실험 결과값을 보여주는 그래프입니다.

- **최적조건**: 가장 높은 만족도 9.37점 → T1, Black, B, On

::: {.callout-note title="망대/망소/망목 특성" collapse="true"}
- **망대(望大)특성**: 값이 클수록 좋은 특성
- **망소(望小)특성**: 값이 작을수록 좋은 특성
- **망목(望目)특성**: 값이 원하는 목표에 근접할수록 좋은 특성
:::

---

## General Full Factorial Design {#general-ffd}

![슬라이드 29](../images/ch06/slide_29.png){width=100%}

**General Full Factorial Design**: 고려된 모든 인자들의 수준조합에서 실험을 실시합니다.

- 인자별 수준수가 **다양한 경우**의 실험에 사용
- 반복이 있는 경우, 가능한 **모든 효과**의 확인 가능
- 실험의 실시는 **랜덤한 순서**로 진행 (완전 랜덤화 설계, CRD)
- 소수의 인자들을 고려하는 **최적화에 유용**

![슬라이드 30](../images/ch06/slide_30.png){width=100%}

**분석 절차**: 그래프 고찰 → 분산분석 → 분석 후 추정

### STB 4.2 실습 — 동영상 화질 밝기

![슬라이드 31](../images/ch06/slide_31.png){width=100%}

OO제품의 저조도 동영상 화질 밝기 최적화 실험입니다.

- **인자**: Frame Rate(2수준: 15, 30), 조도(3수준: 30, 65, 100)
- **반복**: 2회
- **총 실험 횟수**: 2 × 3 × 2 = 12회

#### (1) 실험 설계

![슬라이드 32](../images/ch06/slide_32.png){width=100%}

**Minitab 경로**: Stat > DoE > Factorial > Create Factorial Design

인자의 수와 수준수가 많지 않은 경우, **실제 인자의 이름과 수준 값**을 지정하는 것이 분석 결과 해석에 유용합니다.

![슬라이드 33](../images/ch06/slide_33.png){width=100%}

실험의 실시 순서와 해당 수준 조합은 항상 동일하지 않습니다 — **랜덤화**입니다.

#### (2) 분산분석

![슬라이드 34](../images/ch06/slide_34.png){width=100%}

**Minitab 경로**: Stat > DoE > Factorial > Analyze Factorial Design

실험인 경우 **표준화 잔차**를 지정하고, 확인하고자 하는 주효과와 교호작용 효과를 지정합니다.

![슬라이드 35](../images/ch06/slide_35.png){width=100%}

**결과**: 유의수준 5%하에서 주효과가 통계적으로 **유의**합니다.

#### (3) 그래프 분석

![슬라이드 36](../images/ch06/slide_36.png){width=100%}

**Minitab 경로**: Stat > DoE > Factorial > Factorial Plots

![슬라이드 37](../images/ch06/slide_37.png){width=100%}

**Main Effects Plot**: Frame Rate의 효과가 조도보다 약간 커 보이며, Frame Rate이 높을수록 화질 밝기는 선형적으로 감소하는 경향입니다.

**Interaction Plot**: 조도의 수준이 변할 때 Frame Rate의 각 수준에서의 평균값 변화 방향이 거의 유사하므로, **교호작용은 없어 보입니다**.

#### (4) 최적조건 추정

![슬라이드 38](../images/ch06/slide_38.png){width=100%}

(Frame Rate, 조도) = (15, 100)의 밝기가 **78.7로 최대값**을 제공합니다. 최적 조건에서 새로운 실험 단위를 실험하여 비슷한 밝기를 달성하는지를 확인합니다.

::: {.callout-tip title="ANOVA와의 비교" collapse="true"}
![슬라이드 39](../images/ch06/slide_39.png){width=100%}

Stat > ANOVA > General Linear Model > Fit General Linear Model로 분석하면 실험계획법의 결과와 **동일한 결과**를 얻을 수 있습니다.
:::

---

## 부분배치법 (Fractional Factorial) {#fractional-factorial}

![슬라이드 40](../images/ch06/slide_40.png){width=100%}

**목적**: 최소한의 실험 횟수로 많은 수의 인자를 실험하기 위하여 사용

**적용 시점**:

- 많은 가인자 중 치명인자를 찾기 위한 **Screening** 시
- 경제성을 고려하여 완전배치가 어려운 경우

**배경**: 인자 수가 늘어나면 실험 횟수가 기하급수적으로 증가 (2⁴=16, 2⁵=32, 2⁶=64). 경험적으로 3차 이상의 교호작용이 유의한 경우는 거의 없으므로, 유의하지 않은 고차 교호작용을 **희생**하면서 실험 횟수를 줄입니다.

### 설계 방법

![슬라이드 41](../images/ch06/slide_41.png){width=100%}

**Step 1. 생성자(Generator) 결정을 통한 교락설계**

- 생성자는 포기하는 효과(주로 최고차의 교호작용)
- 예: 생성자 I = ABCD — ABCD의 교호작용을 포기
- 2차 교호작용은 유의할 수 있으므로 가급적 생성자로 사용하지 않음

![슬라이드 42](../images/ch06/slide_42.png){width=100%}

**Step 2. Block 선택 및 실험**

- ABCD = +1 또는 -1인 Block 중 하나를 선택하여 실험 → **½ 실험계획** (2⁴⁻¹)
- 임의로 Run을 선택하면 직교성이 깨어지므로, 반드시 +1 또는 -1 Block으로 선택

**별명(Alias) 관계**: 각 효과와 생성자를 곱하면 교락 관계를 확인할 수 있습니다.

- A × ABCD = BCD → A인자의 효과에 BCD 3차 교호작용이 교락
- AB × ABCD = CD → AB 교호작용에 CD 교호작용이 교락

### 부분배치 실습

![슬라이드 43](../images/ch06/slide_43.png){width=100%}

OO제품 Memory 사용량(Mb) 최적화를 위한 2⁵⁻¹ 부분배치 실험입니다. 5가지 가인자 중 어떤 인자가 Vital Few인가를 확인하는 것이 목적입니다.

![슬라이드 44](../images/ch06/slide_44.png){width=100%}

**Minitab 경로**: Stat > DoE > Factorial > Create Factorial Design → ½ Fraction 선택

::: {.callout-note title="Fold Design" collapse="true"}
부분배치에서 고려된 인자(들)의 **반대 수준**을 실험에 추가하여 교락된 교호작용 효과를 분리해 내는 방법입니다. 특정 인자를 Fold하면 해당 인자에 교락된 교호작용이 분리됩니다.
:::

### 해상도 (Resolution)

![슬라이드 45](../images/ch06/slide_45.png){width=100%}

인자의 분해 능력을 나타내는 단위로, 교호작용 효과를 어느 정도까지 확인할 것인지 결정합니다.

| Resolution | 확인 가능 범위 | 교락 구조 계산 |
|-----------|---------------|---------------|
| **Ⅲ** | 주효과만 확인 | 주효과가 2차 교호작용과 교락 |
| **Ⅳ** | 주효과 + 일부 2차 교호작용 | 2차 교호작용끼리 교락 |
| **Ⅴ** | 주효과 + 모든 2차 교호작용 | 주효과는 4차 교호작용과 교락 |

**교락구조 계산**: Resolution No - 효과의 차수 = 교락된 교호작용의 차수

![슬라이드 46](../images/ch06/slide_46.png){width=100%}

2⁵⁻¹ 설계에서 해상도 V → 2차 교호작용은 모두 확인 가능하며, 3차 이상의 교호작용은 주효과 또는 2차 교호작용에 교락됩니다. 부분배치법은 주효과 해석에 Focus합니다.

---

## RCBD (블록설계) {#rcbd}

![슬라이드 47](../images/ch06/slide_47.png){width=100%}

**RCBD (Randomized Complete Block Design)**: 실험 환경을 블록(Block)이라 불리는 여러 개의 동질적인 부분으로 구분하여 실험하는 설계 방법입니다.

- 각 블록 내에서 **모든 인자의 수준** 또는 수준 조합을 시행 (Complete)
- **블록 내**: 동질적 / **블록 간**: 이질적
- 블록이 올바로 선정된 경우, 실험 오차를 줄여 인자의 수준 간 차이를 더 **정밀하게** 고찰

**가능한 블록인자**: 제품 종류, 설비 호기, 실험 일자, 생산 Lot, 담당 작업자 등

::: {.callout-note title="RCBD 특징" collapse="true"}
- 데이터 구조는 블록인자를 추가 인자로 하는 FD와 동일
- 분산분석 절차와 결과 해석은 FD와 동일 (단, 블록인자는 검정 대상이 아님)
- 블록이 잘 나누어질 수 있는 경우, 단순 반복보다는 반복을 **블록으로 설정**하는 것이 유리
- 블록 간 큰 차이가 없다면, 블록 효과를 오차항에 Pooling
:::

### STB 4.3 실습 — 외장재 신장도

![슬라이드 48](../images/ch06/slide_48.png){width=100%}

OO전자 외장재의 신장도(Kg)에 영향을 주는 "온도" 인자에 대해, 납품사(S1~S4)를 블록으로 설정한 실험입니다.

- **인자**: 온도 3수준(T1, T2, T3)
- **블록**: 납품사 4곳(S1~S4)
- **총 실험 횟수**: 3 × 4 = 12회

**CRD vs RCBD**: CRD에서는 납품사 간 재료 차이가 있으면 온도의 효과를 구별할 수 없지만, RCBD에서는 각 납품사별로 모든 온도를 실험하므로 **재료 차이를 제거/상쇄**할 수 있습니다.

#### Minitab 실습

![슬라이드 49](../images/ch06/slide_49.png){width=100%}

단일 인자의 경우, 블록인자를 **추가 인자로 간주**하고 설계합니다. 설계 후 블록인자를 구별하여 분석합니다.

![슬라이드 50](../images/ch06/slide_50.png){width=100%}

각 Supplier별 실험 단위가 모든 온도에서 실험됩니다.

![슬라이드 51](../images/ch06/slide_51.png){width=100%}

**Minitab 경로**: Stat > ANOVA > General Linear Model > Fit General Linear Model

블록인자는 일반적으로 **변량인자**로 간주합니다.

![슬라이드 52](../images/ch06/slide_52.png){width=100%}

**그래프 분석**: Temp의 주효과가 있으며, Supplier의 차이가 매우 커 보입니다.

![슬라이드 53](../images/ch06/slide_53.png){width=100%}

**결과**: 유의수준 5%하에서 온도는 **유의한 차이**를 갖습니다. 잔차는 모든 가정을 적절히 만족합니다.

::: {.callout-tip title="블록 처리의 중요성" collapse="true"}
Supplier를 Block 인자로 처리하지 않고 Temp에 대한 차이만 분석하면 R²가 30.73%로 낮아지고 P-value = 0.192로 유의하지 않게 됩니다. 블록 설정을 통한 실험설계는 매우 중요한 **프로세스 지식**을 제공합니다.
:::

---

## 반응표면분석 (RSM) {#rsm}

![슬라이드 54](../images/ch06/slide_54.png){width=100%}

**RSM (Response Surface Methodology)**: 실험에서 고려되는 인자들이 모두 계량인자인 경우, 특성치(Y)의 최적값 도출을 위한 수리적·통계적 기법의 총칭입니다.

**RSM의 절차**:

1. **중요인자 선별** → A단계 결과 또는 Screening 실험
2. **관심 영역 결정** → 최대 경사법(MoSA)으로 최적값이 존재할 구간으로 이동
3. **최적 조건 결정** → CCD, BBD로 정확한 관계 도출

::: {.callout-note}
최대경사법을 반드시 거쳐야 하는 것은 아니고, A단계 결과로부터 CCD 실험을 곧바로 실시할 수도 있습니다.
:::

---

### 최대경사법 (MoSA)

![슬라이드 55](../images/ch06/slide_55.png){width=100%}

**MoSA (Method of Steepest Ascent)**: 축차적인 실험을 통하여, 원하는 반응값 방향으로 이동해 가는 방법입니다.

- **설계**: 2-Level FD + Center Points
- 최소의 실험으로 최적 조건이 있을 것으로 예상되는 영역으로 이동하는 것이 주목적

**중심점(Center Point)을 고려하는 이유**:

1. 현재 실험의 수준 점검 (실험이 제대로 진행되고 있는가)
2. 실험 오차의 수량화 (LoF Test 시행)
3. **2차(곡면) 효과의 확인** (1차 모형이 적절한가)

### STB 4.4 실습 — 신제품 출력 최적화

![슬라이드 56](../images/ch06/slide_56.png){width=100%}

OO전자 신제품의 목표 출력(%) 최적화 실험입니다. (출력 70% 이상 필요)

- **인자**: Set 내 온도(150, 160), 회전 Cycle(50, 70)
- **중심점**: (155, 60)에서 5번 반복
- Pilot Test 결과: 온도 155F, Cycle 60에서 출력 약 40%

::: {.callout-note title="Coded vs Uncoded" collapse="true"}
인자별 수준 값들은 단위나 Scale이 다양할 수 있으므로, 낮은 수준을 -1, 높은 수준을 +1로 표준화하여 설계하면 해석이 편리해집니다. 이를 Coded라 하고, 실제 값을 사용하면 Uncoded라 합니다.
:::

#### (1) 초기 실험 설계

![슬라이드 57](../images/ch06/slide_57.png){width=100%}

![슬라이드 58](../images/ch06/slide_58.png){width=100%}

**Minitab 경로**: Stat > DoE > Factorial > Create Factorial Design

2인자 2수준 완전배치 4회에 중심점 반복 5회를 추가하여 **9회의 실험**으로 설계됩니다.

#### (2) 1차 모형 검정

![슬라이드 59](../images/ch06/slide_59.png){width=100%}

**등고선 분석** (Graph > Contour Plot): 출력이 커지는 방향을 확인합니다.

결론적으로 1차 모형이 적합하며, 현재 조건이 최적 조건이 아닐 가능성이 크므로 **추가 개선의 가능성**이 있습니다.

![슬라이드 60](../images/ch06/slide_60.png){width=100%}

**통계적 검정**: 유의수준 5%하에서 곡선 효과가 유의하지 않으므로, 현재 가정된 **1차 모형이 타당**합니다.

#### (3) 최대경사 방향 결정

![슬라이드 61](../images/ch06/slide_61.png){width=100%}

**Define Custom RSD**: 기존 2인자 2수준 + 중심점 실험 데이터를 반응표면실험 설계로 인식하도록 변환합니다.

![슬라이드 62](../images/ch06/slide_62.png){width=100%}

![슬라이드 63](../images/ch06/slide_63.png){width=100%}

**Minitab 경로**: Stat > DOE > Response Surface > Analyze RSD

- 유의수준 5%하에서 고려한 인자들은 모두 유의
- LoF Test P-value 확인: 모형이 타당하지 않다고 할 수 없음

::: {.callout-important}
반응표면 실험은 중심점에서 반복 실험이 기본이므로, 모형의 타당성을 **LoF Test의 P-value**로 진단해야 합니다.
:::

#### (4) 시각화

![슬라이드 64](../images/ch06/slide_64.png){width=100%}

![슬라이드 65](../images/ch06/slide_65.png){width=100%}

초기 실험의 반응표면 형태:

- 온도가 증가하면서 출력 증가
- Cycle 수가 증가하면서 출력 증가
- 온도의 단위 증가에 비해 **Cycle의 단위 증가가 출력 증가에 더 큰 영향**

최대경사 방향: Coded (1 : 2.38) → Uncoded (5 : 23.8)

#### (5) 최대경사 방향 이동

![슬라이드 66](../images/ch06/slide_66.png){width=100%}

기술적 고찰에 의해 Temp는 2.5, Cycle은 12 정도씩 증가시키며 최적 영역을 확인합니다.

![슬라이드 67](../images/ch06/slide_67.png){width=100%}

**결과**: Step 10, (Temp, Cycle) = (180, 180)에서 **최대 출력**을 가지는 것으로 판단됩니다.

#### (6) 확인 실험

![슬라이드 68](../images/ch06/slide_68.png){width=100%}

새로운 중심점 (180, 180) 기준으로 확인 실험(2ⁿ + 중심점)을 실시합니다.

- Temp: (175, 185), Cycle: (170, 190), 중심점 5번 반복

![슬라이드 69](../images/ch06/slide_69.png){width=100%}

**결과**: 1차 모형이 적절하지 않고 (2차 곡면이 적절), 반응값으로 보아 **최적 영역**인 것으로 판단됩니다. 필요시 최적 영역을 좁힌 수준에서 추가 실험을 수행할 수 있습니다.

---

### 중심합성설계 (CCD)

![슬라이드 70](../images/ch06/slide_70.png){width=100%}

**CCD (Central Composite Design)**: 최적 반응값 근처라고 판단된 경우, 인자들과 반응값 간의 관계를 도출하여 **최적조건을 결정**하는 방법입니다.

- **2차 모형(곡면)**을 통해 반응표면을 고찰
- 2-Level FD를 중심으로, **중심점과 축점을 추가**하여 설계

**CCD의 설계점**:

| 설계점 | 설명 | Point Type |
|--------|------|-----------|
| **요인점 (Cube points)** | 2ⁿ FD의 설계점 | 1 |
| **중심점 (Center points)** | 요인점의 정 중앙 | 0 |
| **축점 (Axial points)** | 각 인자의 축을 따라 중심점으로부터 ±α 거리 | -1 |

::: {.callout-tip title="CCD 설계 옵션" collapse="true"}
- **회전가능 설계 (Rotatable Design)**: 중심점에서 모든 점까지의 거리가 동일 (Default)
- **내접설계 (Face Centered Design)**: 축점을 요인점의 수준으로 좁혀 Alpha = 1로 설계, 회전성은 없어짐
- **BBD (Box-Behnken Design)**: 실험점이 요인점의 수준과 동일한 수준으로 설계, **3인자 이상**에서만 사용
:::

### STB 4.7 실습 — CCD 단일 반응 최적화

![슬라이드 71](../images/ch06/slide_71.png){width=100%}

최대경사법으로 확인된 최적 영역에서 CCD를 통해 최적 관계를 도출합니다. 확인실험 결과를 그대로 이용하면서 4번의 **추가 실험(축점)**을 추가합니다.

#### (1) CCD 설계

![슬라이드 72](../images/ch06/slide_72.png){width=100%}

**Minitab 경로**: Stat > DOE > Response Surface > Create Response Surface Design

고려하는 인자의 수준을 **요인점 기준**으로 입력합니다.

![슬라이드 73](../images/ch06/slide_73.png){width=100%}

실험점의 종류: 0(중심점), 1(요인점), -1(축점)

#### (2) CCD 분석

![슬라이드 74](../images/ch06/slide_74.png){width=100%}

**Minitab 경로**: Stat > DOE > Response Surface > Analyze Response Surface Design

최적 영역 근처에서의 분석은 **Full Quadratic 모형**에서 시작하여 유의하지 않은 항을 제거합니다.

![슬라이드 75](../images/ch06/slide_75.png){width=100%}

**결과**:

- 추정된 회귀선이 전체 변동의 **98.26%**를 설명
- LoF Test: 현재 모형이 타당하지 않다고 할 수 없음
- 잔차 진단: 모든 가정이 적절히 만족

::: {.callout-warning}
유의하지 않은 항이라도 Pooling 후 MSE가 올라가면 **Pooling하지 않습니다**.
:::

#### (3) 시각화

![슬라이드 76](../images/ch06/slide_76.png){width=100%}

![슬라이드 77](../images/ch06/slide_77.png){width=100%}

**Minitab 경로**: Stat > DOE > Response Surface > Contour/Surface Plot

최적 조건: Temp 180.5~183.5, Cycle 181~185 정도. 초기 실험에서 출력 약 40%에서 최적 조건에서 **약 85% 이상**으로 개선되었습니다.

#### (4) Response Optimizer

![슬라이드 78](../images/ch06/slide_78.png){width=100%}

**Minitab 경로**: Stat > DOE > Response Surface > Response Optimizer

- **Weight**: 목표값을 강조하는 정도 (0.1~10)
- **Importance**: 반응변수의 상대적 중요도 (0.1~10)

![슬라이드 79](../images/ch06/slide_79.png){width=100%}

선을 이동해 가며 반응변수의 값과 **Desirability** 값을 확인합니다.

---

### STB 4.8 실습 — 다중 반응 최적화

![슬라이드 80](../images/ch06/slide_80.png){width=100%}

TV개발팀의 계조별 색온도 변동량(Project Y) 최적화 실험입니다. Side Effect인 색온도와 휘도까지 동시에 고려합니다.

- **인자**: LL(0.6, 0.7), ML(2.04, 2.14)
- **요구사항**: 색온도 변동량 ≤ 765, 색온도 7580~7590, 휘도 ≥ 591

#### (1) CCD 설계 및 분석

![슬라이드 81](../images/ch06/slide_81.png){width=100%}

![슬라이드 82](../images/ch06/slide_82.png){width=100%}

각 반응변수(Project Y, CT, LUM)에 대해 개별적으로 분석을 수행합니다.

**Project Y 분석**:

![슬라이드 83](../images/ch06/slide_83.png){width=100%}

![슬라이드 84](../images/ch06/slide_84.png){width=100%}

유의수준 5%하에서 모든 항의 회귀계수가 유의하며, R² = 98.26%, LoF Test 통과, 잔차 진단 만족합니다.

**CT(색온도) 분석**:

![슬라이드 85](../images/ch06/slide_85.png){width=100%}

![슬라이드 86](../images/ch06/slide_86.png){width=100%}

Pooling 시 MSE가 높아지므로 Pooling하지 않습니다.

**LUM(휘도) 분석**:

![슬라이드 87](../images/ch06/slide_87.png){width=100%}

![슬라이드 88](../images/ch06/slide_88.png){width=100%}

Square 항을 Pooling 후 최종 잔차를 확인합니다.

#### (2) 시각화 — Overlaid Contour Plot

![슬라이드 89](../images/ch06/slide_89.png){width=100%}

**Minitab 경로**: Stat > DOE > Response Surface > Contour Plot

각 반응변수의 요구사항을 등고선으로 확인합니다.

![슬라이드 90](../images/ch06/slide_90.png){width=100%}

**Overlaid Contour Plot**: 모든 관심 반응변수를 동시에 표시하여 요구사항을 모두 만족하는 영역을 확인합니다.

![슬라이드 91](../images/ch06/slide_91.png){width=100%}

흰색(White) 영역이 주어진 조건을 **모두 만족**하는 영역입니다. 대략적인 기준점: (LL, ML) = (0.630, 2.10)

#### (3) Multiple Response Optimization

![슬라이드 92](../images/ch06/slide_92.png){width=100%}

**Minitab 경로**: Stat > DOE > Response Surface > Response Optimizer

모든 관심 반응변수의 Goal을 결정합니다.

![슬라이드 93](../images/ch06/slide_93.png){width=100%}

**결과 해석**:

- 세로의 붉은색 선을 마우스로 이동시켜 반응변수의 값과 **타당도(D, d)**를 확인
- 개별 반응변수의 d가 하나라도 "0"이 되면 D 값도 "0"이 됨
- D와 d 값은 **"1"에 가까울수록** 반응값의 예측이 타당
- D와 d 값이 1에 가까우면서 반응값이 목표에 가장 근접하고, Side effect도 문제되지 않는 인자의 수준을 설정

---

## 실습: DOE 분석 도구

<div class="streamlit-embed">
<iframe
  src="https://sixsigma-apps.streamlit.app/DOE?embed=true"
  height="800"
  style="width:100%;border:none;">
</iframe>
</div>

::: {.callout-note title="실습 도구 기능"}
- **실험 설계 생성**: 인자 수, 수준 입력 → 설계 행렬 자동 생성
- **데이터 입력**: 반응값 입력
- **효과 분석**: 주효과 플롯, 교호작용 플롯, Pareto 차트
- **RSM**: 3D 반응표면, 등고선 플롯, 최적 조건 탐색
:::
